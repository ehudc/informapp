!!!
%html
  %head
    %style * {font-family: 'Lucida Grande', Helvetica, sans-serif;padding:10px;margin:0px;text-align:center;} h2 {font-size:300px;}
    %title Testing???????
    %script(src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js")
    %script(src="https://maps.googleapis.com/maps/api/js?v=3.exp")
    :javascript


      var map;
      function initialize() {
        // Create a simple map.
        map = new google.maps.Map(document.getElementById('map-canvas'), {
            zoom: 4,
            center: {lat: 39.8, lng: -94.6}
        });
        var citiesList = [["New York, New York", 2459115],
            ["Los Angeles, California",	2442047],
            ["Chicago, Illinois", 2379574],
            ["Houston, Texas", 12590119],
            ["Philadelphia, Pennsylvania", 2471217],
            ["Phoenix, Arizona", 2471390],
            ["San Antonio, Texas", 2487796],
            ["San Diego, California", 2487889],
            ["Dallas, Texas", 2388929],
            ["San Jose, California", 2488042],
            ["Austin, Texas", 12590014]//,
            ];
        var geocoder = new google.maps.Geocoder();

        for (var i = 0; i < citiesList.length; ++i) {
            (function() {
                var city = citiesList[i][0];
                var woeid = citiesList[i][1];
                geocoder.geocode( { 'address': city }, function(results, status) {
                    if (status == google.maps.GeocoderStatus.OK) {
                        var loc = new google.maps.LatLng(results[0].geometry.location.lat(), results[0].geometry.location.lng());
                        var datapoint = new google.maps.Data.Feature();
                        datapoint.setGeometry(loc);
                        datapoint.setProperty('name', city);
                        datapoint.setProperty('woeid', woeid);

                        map.data.add(datapoint);
                    } else {
                        console.log("Something got wrong " + status);
                    }
                });
                //if (i % 5 == 0) {
                //mySleep(1000);
                //}
            })()
        }

        map.data.addListener('click', function(event) {
          document.getElementById("info-box").textContent = event.feature.getProperty('woeid');
          handleClick(event.feature.getProperty('woeid'));
        });
      }

      function mySleep(millis) {
        var date = new Date();
        var curDate = null;
        do { curDate = new Date(); }
        while(curDate-date < millis);
      }

      function handleClick(woeid) {
        return woeid;
      }

      google.maps.event.addDomListener(window, 'load', initialize);


  %body{:style => "height: 2000px"}
    %div#map-canvas{:style => "height: 500px; margin: 0px; padding: 0px; "}
    %div#info-box{ :style => "background-color: white; border: 1px solid black; bottom: 30px; height: 20px; padding: 10px; position: absolute; left: 30px; "}
    %div= yield
